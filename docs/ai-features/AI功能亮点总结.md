# AI 功能亮点总结

## 🎯 核心功能概览

本博客系统深度集成了 AI 能力，为内容创作提供全方位的智能辅助，涵盖写作、润色、检索、问答等多个场景。

### 技术定位对比

| 特性           | Agent 开发                           | LangChain 开发               | 本项目                  |
| -------------- | ------------------------------------ | ---------------------------- | ----------------------- |
| **工具调用**   | ✅ 可以调用外部工具（API、数据库等） | ✅ 支持工具链和工具调用      | ❌ 仅调用 LLM API       |
| **自主决策**   | ✅ 可以自主规划任务步骤              | ✅ 支持 Agent 自主决策       | ❌ 固定流程，无自主规划 |
| **反馈循环**   | ✅ 执行-评估-调整的循环              | ✅ 支持多步骤链式调用        | ❌ 单次请求-响应        |
| **多步骤任务** | ✅ 可以分解复杂任务                  | ✅ 支持 Chains 组合          | ❌ 每个功能都是独立调用 |
| **状态管理**   | ✅ 维护任务状态和上下文              | ✅ 支持状态传递              | ❌ 无状态，每次请求独立 |
| **框架**       | 无统一框架，自主实现                 | 使用 LangChain 框架          | 直接使用 OpenAI SDK     |
| **抽象层**     | 自主设计抽象                         | Chains、Agents、Tools 等抽象 | 自定义函数封装          |
| **RAG 实现**   | 自主实现 RAG 逻辑                    | 使用 LangChain 的 RAG 链     | 自己实现向量检索逻辑    |
| **灵活性**     | 完全自主控制                         | 框架提供标准化流程           | 完全自定义实现          |

### 技术定位

本项目属于 **"基于 LLM 的应用开发"** 或 **"AI 辅助功能开发"**，具体特点：

1. **直接 API 调用**：使用 OpenAI SDK 直接调用 Kimi API
2. **自定义 RAG 实现**：自己实现向量检索、上下文构建、Prompt 组装
3. **业务功能导向**：AI 功能服务于具体的业务场景（写作、润色、问答）
4. **轻量级集成**：不依赖大型框架，保持代码简洁可控

---

## ✨ 核心亮点

### 1. 🤖 实时 AI 补全（AI Tab）

**功能描述**：类似 GitHub Copilot 的内联补全功能，在编辑器中实时显示 AI 建议。

**核心亮点**：

- **无缝内联显示**：补全建议以灰色斜体文本直接显示在光标位置，不打断写作流程
- **智能上下文感知**：自动提取光标前 500 字符作为上下文，生成自然的续写内容
- **高性能优化**：500ms 防抖机制，避免频繁 API 调用；位置校验防止异步竞态
- **一键接受**：`Tab` 键接受，`Esc` 键取消，符合用户习惯

**技术实现**：

- 基于 Tiptap/ProseMirror 插件机制
- 使用 `Decoration.widget` 实现不影响文档结构的视觉提示
- 通过事务元数据管理状态，确保 UI 与数据同步

---

### 2. ✍️ 全文润色

**功能描述**：一键润色整篇文章，支持自定义润色要求。

**核心亮点**：

- **全文智能润色**：基于文章整体上下文，优化语言表达、逻辑结构
- **自定义要求**：支持输入特定润色要求（如"使用更正式的语气"、"增加技术细节"等）
- **实时预览**：润色后显示结果对话框，用户确认后一键替换
- **选中文本润色**：支持对选中文本进行局部润色

**技术实现**：

- 使用 Kimi API 进行内容生成
- 支持流式输出，实时显示润色进度
- 编辑器内容实时同步更新

---

### 3. 🔍 RAG 智能问答

**功能描述**：基于博客文章内容的智能问答系统，从知识库中检索相关信息并生成准确回答。

**核心亮点**：

- **语义检索**：使用向量相似度搜索，而非简单的关键词匹配
- **上下文增强**：检索相关文章片段作为上下文，生成更准确的回答
- **来源追溯**：回答附带参考来源，用户可查看原文
- **流式输出**：实时显示回答生成过程，提升用户体验

**技术架构**：

```
用户提问 → Ollama 向量化 → Chroma 相似度搜索 → 检索相关片段 → Kimi 生成回答
```

**技术选型**：

- **LLM**: Kimi (Moonshot AI) - 免费额度充足，中文能力强
- **Embedding**: Ollama + nomic-embed-text - 本地运行，完全免费
- **向量数据库**: Chroma - 开源轻量，HNSW 索引性能优秀

---

### 4. 📝 智能内容生成

**功能描述**：AI 辅助生成文章标题、摘要、标签、分类等元信息。

**核心亮点**：

- **标题生成**：根据内容生成多个标题选项，用户可选择
- **摘要生成**：自动生成文章摘要，支持在发布对话框中一键应用
- **标签/分类推荐**：
  - 区分**已存在**和**新建**两种类型
  - 已存在：从数据库中选择最接近的标签/分类
  - 新建：AI 生成新的标签/分类建议
- **大纲生成**：根据标题生成文章大纲，辅助写作规划

**技术实现**：

- 使用结构化 Prompt，明确区分已存在和新建项
- 前端清晰展示推荐结果，支持一键创建和应用

---

### 5. 🔗 相关文章推荐

**功能描述**：基于语义相似度推荐相关文章。

**核心亮点**：

- **语义相似度**：使用向量检索，而非简单的标签/分类匹配
- **降级机制**：RAG 不可用时，自动降级为标签/分类匹配
- **紧凑展示**：仅显示标题，最多 3 篇，不干扰阅读
- **AI 标识**：AI 推荐的文章显示特殊标识

**技术实现**：

- 使用当前文章的标题和摘要作为查询向量
- 排除当前文章，按相似度排序
- 前端紧凑展示，提升用户体验

---

### 6. 🌊 流式输出

**功能描述**：AI 生成内容时实时流式输出，提升用户体验。

**核心亮点**：

- **实时反馈**：内容生成过程中实时显示，无需等待
- **SSE 技术**：使用 Server-Sent Events 实现服务端推送
- **多场景支持**：RAG 问答、内容生成、润色等功能均支持流式输出
- **状态管理**：前端实时解析 SSE 数据，更新 UI 状态

**技术实现**：

- 后端：Next.js API Routes + SSE
- 前端：EventSource API 解析流式数据
- 支持显示生成进度、来源信息等元数据

---

## 🏗️ 技术架构

### 技术栈

| 组件           | 技术选择                  | 优势                                      |
| -------------- | ------------------------- | ----------------------------------------- |
| **LLM**        | Kimi (Moonshot AI)        | 免费额度充足，中文能力强，兼容 OpenAI SDK |
| **Embedding**  | Ollama + nomic-embed-text | 本地运行保护隐私，完全免费                |
| **向量数据库** | Chroma                    | 开源轻量，HNSW 索引性能优秀               |
| **编辑器**     | Novel (Tiptap)            | 支持 AI 扩展，Markdown 兼容               |
| **后端**       | Next.js API Routes        | 统一技术栈，易于维护                      |

### 核心设计原则

1. **完全免费**：所有 AI 功能使用免费方案，无额外成本
2. **隐私保护**：Embedding 本地运行，敏感数据不上传
3. **降级机制**：关键功能支持降级，保证可用性
4. **用户体验**：流式输出、实时反馈、一键操作

---

## 📊 功能对比

| 功能            | 输入                | 输出                    | 技术                    |
| --------------- | ------------------- | ----------------------- | ----------------------- |
| **AI Tab 补全** | 当前上下文          | 5-30 字续写建议         | Tiptap Extension + Kimi |
| **全文润色**    | 文章内容 + 可选要求 | 润色后的完整文章        | Kimi API                |
| **RAG 问答**    | 用户问题            | 基于知识库的回答 + 来源 | Ollama + Chroma + Kimi  |
| **内容生成**    | 文章内容/标题       | 标题/摘要/标签/分类     | Kimi API                |
| **相关推荐**    | 当前文章            | 3 篇相关文章            | 向量检索 + 降级匹配     |
| **流式输出**    | 所有 AI 请求        | 实时生成内容            | SSE                     |

---

## 🎨 用户体验设计

### 1. 无缝集成

- AI 功能深度集成到编辑器中，不打断写作流程
- 一键操作，无需复杂配置

### 2. 实时反馈

- 流式输出显示生成进度
- 加载状态清晰可见
- 错误提示友好明确

### 3. 智能降级

- RAG 不可用时自动降级为纯 LLM
- 保证功能可用性

---
